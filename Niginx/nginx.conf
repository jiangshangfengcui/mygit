
#user  nobody;
worker_processes  1;

#error_log  logs/error.log;
#error_log  logs/error.log  notice;
#error_log  logs/error.log  info;

#pid        logs/nginx.pid;


events {
    worker_connections  1024;
}


http {
    include       mime.types;
    default_type  application/octet-stream;
    server_names_hash_bucket_size 64;

    #log_format  main  '$remote_addr - $remote_user [$time_local] "$request" '
    #                  '$status $body_bytes_sent "$http_referer" '
    #                  '"$http_user_agent" "$http_x_forwarded_for"';

    #access_log  logs/access.log  main;

    sendfile        on;
    #tcp_nopush     on;

    #keepalive_timeout  0;
    keepalive_timeout  65;

    #gzip  on;

    server {
        listen       80;
        server_name  localhost;

        #charset koi8-r;

        #access_log  logs/host.access.log  main;

        location / {
            root   html;
            index  index.html index.htm;
        }

        #error_page  404              /404.html;

        # redirect server error pages to the static page /50x.html
        #
        error_page   500 502 503 504  /50x.html;
        location = /50x.html {
            root   html;
        }

        # proxy the PHP scripts to Apache listening on 127.0.0.1:80
        #
        #location ~ \.php$ {
        #    proxy_pass   http://127.0.0.1;
        #}

        # pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000
        #
        #location ~ \.php$ {
        #    root           html;
        #    fastcgi_pass   127.0.0.1:9000;
        #    fastcgi_index  index.php;
        #    fastcgi_param  SCRIPT_FILENAME  /scripts$fastcgi_script_name;
        #    include        fastcgi_params;
        #}

        # deny access to .htaccess files, if Apache's document root
        # concurs with nginx's one
        #
        #location ~ /\.ht {
        #    deny  all;
        #}
    }


    # another virtual host using mix of IP-, name-, and port-based configuration
    #
    #server {
    #    listen       8000;
    #    listen       somename:8080;
    #    server_name  somename  alias  another.alias;

    #    location / {
    #        root   html;
    #        index  index.html index.htm;
    #    }
    #}


    # HTTPS server
    #
    #server {
    #    listen       443 ssl;
    #    server_name  localhost;

    #    ssl_certificate      cert.pem;
    #    ssl_certificate_key  cert.key;

    #    ssl_session_cache    shared:SSL:1m;
    #    ssl_session_timeout  5m;

    #    ssl_ciphers  HIGH:!aNULL:!MD5;
    #    ssl_prefer_server_ciphers  on;

    #    location / {
    #        root   html;
    #        index  index.html index.htm;
    #    }
    #}  
        # mingchuang-node
        #server {
        #                 listen                 3000;
        #                 server_name            m.mcyx.com;
        #                 charset utf-8;
        #                 autoindex on;
        #                 autoindex_exact_size off;
        #                 root  D:\project\b2c-brand-h5-web;
        #                location ~ .*\.(gif|jpg|jpeg|png|bmp|swf|js|css|eot|ttf|woff|svg)$
        #                {
        #                       root  D:\project\b2c-brand-h5-web;
        #                       add_header Access-Control-Allow-Origin *;
        #                }
        #        }
        #mingchuang-dev
        server {
                         listen                 88;
                         server_name            localhost;
                         charset utf-8;
                         autoindex on;
                         autoindex_exact_size off;
                         #root  D:\project\mingchuang\dev;
                         root D:\project\miniso-wap;
                        location ~ .*\.(gif|jpg|jpeg|png|bmp|swf|js|css|eot|ttf|woff|svg)$
                        {
                               #root  D:\project\mingchuang\dev;
                               root D:\project\miniso-wap;
                               add_header Access-Control-Allow-Origin *;
                        }
                }

        server {
                 listen                 89;
                 server_name            localhost;
                 charset utf-8;
                 autoindex on;
                 autoindex_exact_size off;
                 root  D:\project\mingchuang\dev;
                 
                location ~ .*\.(gif|jpg|jpeg|png|bmp|swf|js|css|eot|ttf|woff|svg)$ #设定访问静态文件直接读取
                {
                       
                       root  D:\project\mingchuang\dev;
                       add_header Access-Control-Allow-Origin *;
                }
        } 

        server {
                 listen                 80;
                 #server_name            static.i360mall.com;
                 server_name            static.b2c.jcloud.com;
                 charset utf-8;
                 autoindex on;
                 autoindex_exact_size off;
                 #root  D:\project\b2c-h5-nodejs\b2c-static;
                 #root  D:\project\b2c-static;
                 root  D:\project\b2c-brand-static;
                location ~ .*\.(gif|jpg|jpeg|png|bmp|swf|js|css|eot|ttf|woff|svg)$ #设定访问静态文件直接读取
                {
                       #root  D:\project\b2c-h5-nodejs\b2c-static;
                       #root  D:\project\b2c-static;
                       root  D:\project\b2c-brand-static;
                       add_header Access-Control-Allow-Origin *;
                }
        }	
        server {
                 listen                 80;
                 server_name            static.mcyx.com;
                 charset utf-8;
                 autoindex on;
                 autoindex_exact_size off;
                 #root  D:\project\b2c-h5-nodejs\b2c-static;
                 #root  D:\project\b2c-static;
                 root  D:\project\b2c-brand-static;
                location ~ .*\.(gif|jpg|jpeg|png|bmp|swf|js|css|eot|ttf|woff|svg)$ #设定访问静态文件直接读取
                {
                       #root  D:\project\b2c-h5-nodejs\b2c-static;
                       #root  D:\project\b2c-static;
                       root  D:\project\b2c-brand-static;
                       add_header Access-Control-Allow-Origin *;
                }
        }   
        server {
                 listen                 80;
                 #server_name            static.i360mall.com;
                 server_name            static.miniso.cn;
                 charset utf-8;
                 autoindex on;
                 autoindex_exact_size off;
                 #root  D:\project\b2c-h5-nodejs\b2c-static;
                 #root  D:\project\b2c-static;
                 root  D:\project\b2c-brand-static;
                location ~ .*\.(gif|jpg|jpeg|png|bmp|swf|js|css|eot|ttf|woff|svg)$ #设定访问静态文件直接读取
                {
                       #root  D:\project\b2c-h5-nodejs\b2c-static;
                       #root  D:\project\b2c-static;
                       root  D:\project\b2c-brand-static;
                       add_header Access-Control-Allow-Origin *;
                }
        }   
        server {
                 listen                 80;
                 server_name            static.i360mall.com;
                 charset utf-8;
                 autoindex on;
                 autoindex_exact_size off;
                 #root  D:\project\b2c-h5-nodejs\b2c-static;
                 root  D:\project\b2c-static;
                 #root  D:\project\360_third_phase\b2c-static;
                 #root  D:\project\360_third_phase_h5_reserve\b2c-static;
                 #root  D:\project\360_fourth_phase_item_opt\b2c-static;
                location ~ .*\.(gif|jpg|jpeg|png|bmp|swf|js|css|eot|ttf|woff|svg)$ #设定访问静态文件直接读取
                {
                       #root  D:\project\b2c-h5-nodejs\b2c-static;
                       root  D:\project\b2c-static;
                       #root  D:\project\360_third_phase\b2c-static;
                       #root  D:\project\360_third_phase_h5_reserve\b2c-static;
                       #root  D:\project\360_fourth_phase_item_opt\b2c-static;
                       add_header Access-Control-Allow-Origin *;
                }
        }   
        server {
                 listen                 80;
                 server_name            static.senssun.com;
                 charset utf-8;
                 autoindex on;
                 autoindex_exact_size off;
                 #root  D:\project\b2c-h5-nodejs\b2c-static;
                 #root  D:\project\b2c-static;
                 root  D:\project\b2c-brand-static;
                location ~ .*\.(gif|jpg|jpeg|png|bmp|swf|js|css|eot|ttf|woff|svg)$ #设定访问静态文件直接读取
                {
                       #root  D:\project\b2c-h5-nodejs\b2c-static;
                       #root  D:\project\b2c-static;
                       root  D:\project\b2c-brand-static;
                       add_header Access-Control-Allow-Origin *;
                }
        }   
        server {
                 listen                 80;
                 server_name            static.blackshark.com;
                 charset utf-8;
                 autoindex on;
                 autoindex_exact_size off;
                 root  D:\project\b2c-brand-static;
                location ~ .*\.(gif|jpg|jpeg|png|bmp|swf|js|css|eot|ttf|woff|svg)$ #设定访问静态文件直接读取
                {
                       root  D:\project\b2c-brand-static;
                       add_header Access-Control-Allow-Origin *;
                }
        }   
        server {
                 listen                 80;
                 server_name            static.b2c.jdcloud.com;
                 charset utf-8;
                 autoindex on;
                 autoindex_exact_size off;
                 root  D:\project\b2c-brand-static;
                location ~ .*\.(gif|jpg|jpeg|png|bmp|swf|js|css|eot|ttf|woff|svg)$ #设定访问静态文件直接读取
                {
                       root  D:\project\b2c-brand-static;
                       add_header Access-Control-Allow-Origin *;
                }
        }   
        # h5-web项目
		upstream tomcat_h5-web.b2c {
                server 127.0.0.1:8080  weight=10 max_fails=2 fail_timeout=30s;
        }
        # node项目
        upstream tomcat_node-h5-web.b2c {
                server 127.0.0.1:3000  weight=10 max_fails=2 fail_timeout=30s;
        }
        
        # 本地router地址
		upstream tomcat_h5-router-ajax.b2c {
                server 127.0.0.1:8741  weight=10 max_fails=2 fail_timeout=30s;
        }
		server
                {
                listen                   80;
                server_name              n.i360mall.com;
                access_log D:\export\Logs\b2c.jcloud.com\access.log;
                error_log D:\export\Logs\b2c.jcloud.com\error.log;
                 charset utf-8;
                 autoindex on;
                 autoindex_exact_size off;
                root /;
				      	location / {
								        proxy_next_upstream     http_500 http_502 http_503 http_504 error timeout invalid_header;
								        proxy_set_header        Host  $host;
								        proxy_set_header        X-Forwarded-For $proxy_add_x_forwarded_for;
								        proxy_pass              http://tomcat_node-h5-web.b2c;
								        expires                 0;
				        }
				        location ^~ /proxy/ {
				          proxy_next_upstream     http_500 http_502 http_503 http_504 error timeout invalid_header;
								  proxy_set_header        Host  $host;
								  proxy_set_header        X-Forwarded-For $proxy_add_x_forwarded_for;
									proxy_pass 						  http://tomcat_h5-router-html.b2c/;
								}
				        location /logs/ {
				                autoindex       off;
				                deny all;
				        }
				}

        server
                {
                listen                   80;
                server_name              m.i360mall.com;
                access_log D:\export\Logs\b2c.jcloud.com\access.log;
                error_log D:\export\Logs\b2c.jcloud.com\error.log;
                 charset utf-8;
                 autoindex on;
                 autoindex_exact_size off;
                root /;
                        location / {
                                        proxy_next_upstream     http_500 http_502 http_503 http_504 error timeout invalid_header;
                                        proxy_set_header        Host  $host;
                                        proxy_set_header        X-Forwarded-For $proxy_add_x_forwarded_for;
                                        proxy_pass              http://tomcat_h5-web.b2c;
                                        expires                 0;
                        }
                        
                        location /logs/ {
                                autoindex       off;
                                deny all;
                        }


                        location ^~ /secondkill/ {
                                                proxy_next_upstream     http_500 http_502 http_503 http_504 error timeout invalid_header;
                                                proxy_set_header        Host  $host;
                                                proxy_set_header        X-Forwarded-For $proxy_add_x_forwarded_for;
                                                proxy_pass              http://tomcat_h5-web-seckill.b2c;
                                                expires                 0;
                                        }





                }
        upstream tomcat_h5-web-seckill.b2c {
                server 127.0.0.1:8080  weight=10 max_fails=2 fail_timeout=30s;
        }
				
		#线上router地址		
		upstream tomcat_h5-router-html.b2c {
                server 192.168.170.36:18423  weight=10 max_fails=2 fail_timeout=30s;
        }
		server
                {
                listen                   80;
                server_name              m.node.router.i360mall.com;
                access_log D:\export\Logs\b2c.jcloud.com\access.log;
                error_log D:\export\Logs\b2c.jcloud.com\error.log;
                charset utf-8;
                 autoindex on;
                 autoindex_exact_size off;
                root /;
				      	location / {
				      					# proxy_buffer_size 64k;
                				# proxy_buffers   32 32k;
                				# proxy_busy_buffers_size 128k;
								        proxy_next_upstream     http_500 http_502 http_503 http_504 error timeout invalid_header;
								        proxy_set_header        Host  $host;
								        proxy_set_header        X-Forwarded-For $proxy_add_x_forwarded_for;
								        proxy_pass              http://tomcat_h5-router-html.b2c;
								        expires                 0;
				        }
				        location /logs/ {
				                autoindex       off;
				                deny all;
				        }
				}
        # 线上router地址
        upstream tomcat_h5-router-128.b2c {
                server 192.168.180.128:8027  weight=10 max_fails=2 fail_timeout=30s;
        }
        upstream tomcat_oauth-h5-web-128.b2c {
                #server 192.168.180.128:8023  weight=10 max_fails=2 fail_timeout=30s;
                # 名创优选
                server 192.168.180.128:8026  weight=10 max_fails=2 fail_timeout=30s;
        }
        
        server
                {
                        listen                   80;
                        server_name              m.mcyx.com;
                        access_log D:\export\Logs\b2c.jcloud.com\access.log;
                        error_log D:\export\Logs\b2c.jcloud.com\error.log;
                        charset utf-8;
                        autoindex on;
                        autoindex_exact_size off;
                        root /;
                        location / {
                            proxy_next_upstream     http_500 http_502 http_503 http_504 error timeout invalid_header;
                            proxy_set_header        Host  $host;
                            proxy_set_header        X-Forwarded-For $proxy_add_x_forwarded_for;
                            proxy_pass              http://tomcat_node-h5-web.b2c;
                            expires                 0;
                        }
                        location ^~ /proxy/ {
                            proxy_next_upstream     http_500 http_502 http_503 http_504 error timeout invalid_header;
                            proxy_set_header        Host  $host;
                            proxy_set_header        X-Forwarded-For $proxy_add_x_forwarded_for;
                            #proxy_pass              http://tomcat_h5-router-128.b2c/;
                            proxy_pass             http://tomcat_h5-node-router-brand.b2c/;
                        }
                        location ^~ /oauth/ {
                            proxy_next_upstream     http_500 http_502 http_503 http_504 error timeout invalid_header;
                            proxy_set_header        Host  $host;
                            proxy_set_header        X-Forwarded-For $proxy_add_x_forwarded_for;
                            #proxy_pass              http://tomcat_oauth-h5-web-128.b2c;
                            proxy_pass             http://tomcat_h5-node-oauth-brand.b2c;
                        }
                        location /logs/ {
                            autoindex               off;
                            deny all;
                        }
                }
        server
                {
                        listen                   80;
                        server_name              m.b2c.jcloud.com;
                        access_log D:\export\Logs\b2c.jcloud.com\access.log;
                        error_log D:\export\Logs\b2c.jcloud.com\error.log;
                        charset utf-8;
                        autoindex on;
                        autoindex_exact_size off;
                        root /;
                        location / {
                            proxy_next_upstream     http_500 http_502 http_503 http_504 error timeout invalid_header;
                            proxy_set_header        Host  $host;
                            proxy_set_header        X-Forwarded-For $proxy_add_x_forwarded_for;
                            proxy_pass              http://tomcat_node-h5-web.b2c;
                            expires                 0;
                        }
                        # 所有异步请求跳转
                        location ^~ /proxy/ {
                            proxy_next_upstream     http_500 http_502 http_503 http_504 error timeout     invalid_header;
                            proxy_set_header        Host  $host;
                            proxy_set_header        X-Forwarded-For $proxy_add_x_forwarded_for;
                            #proxy_pass                        http://tomcat_h5-router-128.b2c/;
                            proxy_pass                   http://tomcat_h5-node-router-brand.b2c/;
                        }
                        location ^~ /oauth/ {# 所有oauth路径下的请求跳转
                            proxy_next_upstream     http_500 http_502 http_503 http_504 error timeout invalid_header;
                            proxy_set_header        Host  $host;
                            proxy_set_header        X-Forwarded-For $proxy_add_x_forwarded_for;
                            #proxy_pass                       http://tomcat_oauth-h5-web-128.b2c;
                            proxy_pass                    http://tomcat_h5-node-oauth-brand.b2c;
                                }
                        location /logs/ {
                            autoindex       off;
                            deny all;
                        }
                }
        server
                {
                        listen                   80;
                        server_name              m.senssun.com;
                        access_log D:\export\Logs\b2c.jcloud.com\access.log;
                        error_log D:\export\Logs\b2c.jcloud.com\error.log;
                        charset utf-8;
                        autoindex on;
                        autoindex_exact_size off;
                        root /;
                        location / {
                            proxy_next_upstream     http_500 http_502 http_503 http_504 error timeout invalid_header;
                            proxy_set_header        Host  $host;
                            proxy_set_header        X-Forwarded-For $proxy_add_x_forwarded_for;
                            proxy_pass              http://tomcat_node-h5-web.b2c;
                            expires                 0;
                        }
                        # 所有异步请求跳转
                        location ^~ /proxy/ {
                            proxy_next_upstream     http_500 http_502 http_503 http_504 error timeout     invalid_header;
                            proxy_set_header        Host  $host;
                            proxy_set_header        X-Forwarded-For $proxy_add_x_forwarded_for;
                            #proxy_pass                        http://tomcat_h5-router-128.b2c/;
                            proxy_pass                   http://tomcat_h5-node-router-brand.b2c/;
                        }
                        location ^~ /oauth/ {# 所有oauth路径下的请求跳转
                            proxy_next_upstream     http_500 http_502 http_503 http_504 error timeout invalid_header;
                            proxy_set_header        Host  $host;
                            proxy_set_header        X-Forwarded-For $proxy_add_x_forwarded_for;
                            #proxy_pass                       http://tomcat_oauth-h5-web-128.b2c;
                            proxy_pass                    http://tomcat_h5-node-oauth-brand.b2c;
                                }
                        location /logs/ {
                            autoindex       off;
                            deny all;
                        }
                }
        server
                {
                        listen                   80;
                        server_name              m.blackshark.com;
                        access_log D:\export\Logs\b2c.jcloud.com\access.log;
                        error_log D:\export\Logs\b2c.jcloud.com\error.log;
                        charset utf-8;
                        autoindex on;
                        autoindex_exact_size off;
                        root /;
                        location / {
                            proxy_next_upstream     http_500 http_502 http_503 http_504 error timeout invalid_header;
                            proxy_set_header        Host  $host;
                            proxy_set_header        X-Forwarded-For $proxy_add_x_forwarded_for;
                            proxy_pass              http://tomcat_node-h5-web.b2c;
                            expires                 0;
                        }
                        # 所有异步请求跳转
                        location ^~ /proxy/ {
                            proxy_next_upstream     http_500 http_502 http_503 http_504 error timeout     invalid_header;
                            proxy_set_header        Host  $host;
                            proxy_set_header        X-Forwarded-For $proxy_add_x_forwarded_for;
                            #proxy_pass                        http://tomcat_h5-router-128.b2c/;
                            proxy_pass                   http://tomcat_h5-node-router-brand.b2c/;
                        }
                        location ^~ /oauth/ {# 所有oauth路径下的请求跳转
                            proxy_next_upstream     http_500 http_502 http_503 http_504 error timeout invalid_header;
                            proxy_set_header        Host  $host;
                            proxy_set_header        X-Forwarded-For $proxy_add_x_forwarded_for;
                            #proxy_pass                       http://tomcat_oauth-h5-web-128.b2c;
                            proxy_pass                    http://tomcat_h5-node-oauth-brand.b2c;
                                }
                        location /logs/ {
                            autoindex       off;
                            deny all;
                        }
                }
        server
                {
                        listen                   80;
                        server_name              m.b2c.jdcloud.com;
                        access_log D:\export\Logs\b2c.jcloud.com\access.log;
                        error_log D:\export\Logs\b2c.jcloud.com\error.log;
                        charset utf-8;
                        autoindex on;
                        autoindex_exact_size off;
                        root /;
                        location / {
                            proxy_next_upstream     http_500 http_502 http_503 http_504 error timeout invalid_header;
                            proxy_set_header        Host  $host;
                            proxy_set_header        X-Forwarded-For $proxy_add_x_forwarded_for;
                            proxy_pass              http://tomcat_node-h5-web.b2c;
                            expires                 0;
                        }
                        # 所有异步请求跳转
                        location ^~ /proxy/ {
                            proxy_next_upstream     http_500 http_502 http_503 http_504 error timeout     invalid_header;
                            proxy_set_header        Host  $host;
                            proxy_set_header        X-Forwarded-For $proxy_add_x_forwarded_for;
                            #proxy_pass                        http://tomcat_h5-router-128.b2c/;
                            proxy_pass                   http://tomcat_h5-node-router-brand.b2c/;
                        }
                        location ^~ /oauth/ {# 所有oauth路径下的请求跳转
                            proxy_next_upstream     http_500 http_502 http_503 http_504 error timeout invalid_header;
                            proxy_set_header        Host  $host;
                            proxy_set_header        X-Forwarded-For $proxy_add_x_forwarded_for;
                            #proxy_pass                       http://tomcat_oauth-h5-web-128.b2c;
                            proxy_pass                    http://tomcat_h5-node-oauth-brand.b2c;
                                }
                        location /logs/ {
                            autoindex       off;
                            deny all;
                        }
                }
        server
                {
                        listen                   80;
                        server_name              m-router.b2c.jcloud.com;
                        access_log D:\export\Logs\b2c.jcloud.com\access.log;
                        error_log D:\export\Logs\b2c.jcloud.com\error.log;
                        charset utf-8;
                        autoindex on;
                        autoindex_exact_size off;
                        root /;
                        location ^~ /proxy/ {
                           proxy_next_upstream     http_500 http_502 http_503 http_504 error timeout invalid_header;
                           proxy_set_header        Host  $host;
                           proxy_set_header        X-Forwarded-For $proxy_add_x_forwarded_for;
                           proxy_pass               http://tomcat_h5-router-128.b2c/;
                           #proxy_pass              http://tomcat_h5-router-ajax.b2c/;
                        }
                        location /logs/ {
                           autoindex       off;
                           deny all;
                        }
                }

        # brand 
         upstream tomcat_h5-node-router-brand.b2c {
                  server 192.168.180.128:8027  weight=10 max_fails=2 fail_timeout=30s;
                  #server 192.168.180.126:8888  weight=10 max_fails=2 fail_timeout=30s;
          }
         upstream tomcat_h5-node-oauth-brand.b2c {
                  server 192.168.180.128:8026  weight=10 max_fails=2 fail_timeout=30s;
                  #server 192.168.180.126:8889  weight=10 max_fails=2 fail_timeout=30s;
          }






				
    include servers/*;
}